<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Embedded IoT 플랫폼에서 Wi-Fi 지원 - All about IoT</title><meta name=Description content><meta property="og:url" content="https://blog.humminglab.io/posts/wifi-for-iot-product/">
<meta property="og:site_name" content="All about IoT"><meta property="og:title" content="Embedded IoT 플랫폼에서 Wi-Fi 지원"><meta property="og:description" content="Embedded 형태의 IoT의 센서 노드를 개발하기 위한 플랫폼(HW + SW SDK)은 다양해져서 잠깐만 인터넷 검색을 해보아도 여러 솔루션을 찾아 볼 수 있다. 특히 센서 노드의 특성 상 이들 SDK는 IEEE 802.15.4(Zigbee, Thread), IEEE 802.15.1(Bluetooth, BLE), IEEE 802.11(Wi-Fi)와 같은 wireless internet connectivity가 주요 기능으로 들어간다.
이 문서에서는 제품에 Wi-Fi 기능을 넣기 위하여 솔루션 선정 시 고려할 사항들을 정리한다.
Constrained DevicesIoT 센서 기기와 같은 경우는 배터리로 구동하거나, 낮은 사양 등 일반 PC 나 android 기기에 비하여 저사양 기기라고 할 수 있다. 보통 이를 constrained device 라고 한다(자세한 정의는 RFC 7228 Terminology for Constrained-Node Networks 참고). 여기에서는 이를 ‘저사양 기기’라고 표기한다. 이들 저사양 기기는 일반 PC, 네트워크 환경에 비교하여 일반적으로 다음과 같은 사항 중 하나 이상에 해당될 수 있다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-04-17T05:00:00+09:00"><meta property="article:modified_time" content="2018-04-17T05:00:00+09:00"><meta property="article:tag" content="IoT"><meta property="article:tag" content="Wi-Fi"><meta name=twitter:card content="summary"><meta name=twitter:title content="Embedded IoT 플랫폼에서 Wi-Fi 지원"><meta name=twitter:description content="Embedded 형태의 IoT의 센서 노드를 개발하기 위한 플랫폼(HW + SW SDK)은 다양해져서 잠깐만 인터넷 검색을 해보아도 여러 솔루션을 찾아 볼 수 있다. 특히 센서 노드의 특성 상 이들 SDK는 IEEE 802.15.4(Zigbee, Thread), IEEE 802.15.1(Bluetooth, BLE), IEEE 802.11(Wi-Fi)와 같은 wireless internet connectivity가 주요 기능으로 들어간다.
이 문서에서는 제품에 Wi-Fi 기능을 넣기 위하여 솔루션 선정 시 고려할 사항들을 정리한다.
Constrained DevicesIoT 센서 기기와 같은 경우는 배터리로 구동하거나, 낮은 사양 등 일반 PC 나 android 기기에 비하여 저사양 기기라고 할 수 있다. 보통 이를 constrained device 라고 한다(자세한 정의는 RFC 7228 Terminology for Constrained-Node Networks 참고). 여기에서는 이를 ‘저사양 기기’라고 표기한다. 이들 저사양 기기는 일반 PC, 네트워크 환경에 비교하여 일반적으로 다음과 같은 사항 중 하나 이상에 해당될 수 있다."><meta name=application-name content="All about IoT"><meta name=apple-mobile-web-app-title content="All about IoT"><meta name=theme-color content="#f8f8f8"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=canonical href=https://blog.humminglab.io/posts/wifi-for-iot-product/><link rel=prev href=https://blog.humminglab.io/posts/python-coroutine-programming-2/><link rel=next href=https://blog.humminglab.io/posts/wiced-event-loop/><link rel=stylesheet href=/css/main.min.css><link rel=stylesheet href=/css/style.min.css><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Embedded IoT 플랫폼에서 Wi-Fi 지원","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.humminglab.io/posts/wifi-for-iot-product/"},"genre":"posts","keywords":["IoT","Wi-Fi"],"wordcount":1545,"url":"https://blog.humminglab.io/posts/wifi-for-iot-product/","datePublished":"2018-04-17T05:00:00+09:00","dateModified":"2018-04-17T05:00:00+09:00","publisher":{"@type":"Organization","name":"HummingLab"},"author":[{"@type":"Person","name":"YSLee","url":"https://www.humminglab.io"}],"description":""}</script></head><body data-instant-intensity=viewport><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.className=e,document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark"),e==="light"?document.documentElement.classList.remove("tw-dark"):document.documentElement.classList.add("tw-dark"),window.theme=e,window.isDark=window.theme!=="light"}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else""==="light"||""==="dark"?(setTheme(""),saveTheme("")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#161b22"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")],window.switchThemeEventSet=new Set</script><div id=back-to-top></div><div id=mask></div><header class="desktop print:!tw-hidden" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="All about IoT">All about IoT</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=https://www.humminglab.io/ rel="noopener noreferrer" target=_blank>HummingLab </a><span class="menu-item delimiter"></span><button class="menu-item theme-switch" aria-label="Switch Theme"><svg class="icon" viewBox="0 0 512 512"><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705.0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg></button></div></div></div></header><header class="mobile print:!tw-hidden" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="All about IoT">All about IoT</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=https://www.humminglab.io/ title rel="noopener noreferrer" target=_blank>HummingLab</a><button class="menu-item theme-switch tw-w-full" aria-label="Switch Theme"><svg class="icon" viewBox="0 0 512 512"><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705.0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg></button></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=tw-mx-4><div class="toc print:!tw-hidden" id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#constrained-devices>Constrained Devices</a></li><li><a href=#저사양-기기를-위한-wi-fi-지원>저사양 기기를 위한 Wi-Fi 지원</a></li><li><a href=#at-command-형태의-wi-fi-interface>AT command 형태의 Wi-Fi interface</a></li><li><a href=#일반-wi-fi-모듈>일반 Wi-Fi 모듈</a></li><li><a href=#마치며>마치며</a></li></ul></nav></div></div><dialog id=toc-dialog class="tw-max-w-full tw-w-full tw-max-h-full tw-h-full tw-ml-16"><div class="toc tw-mx-4 tw-max-w-full"><h2 class="tw-mx-0 tw-my-6 tw-uppercase tw-text-2xl">Contents</h2><div class=toc-content><nav id=TableOfContents><ul><li><a href=#constrained-devices>Constrained Devices</a></li><li><a href=#저사양-기기를-위한-wi-fi-지원>저사양 기기를 위한 Wi-Fi 지원</a></li><li><a href=#at-command-형태의-wi-fi-interface>AT command 형태의 Wi-Fi interface</a></li><li><a href=#일반-wi-fi-모듈>일반 Wi-Fi 모듈</a></li><li><a href=#마치며>마치며</a></li></ul></nav></div></div></dialog><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single print:!tw-w-full print:!tw-max-w-none print:!tw-m-0 print:!tw-p-0"><h1 class=single-title data-pagefind-meta=date:2018-04-17 data-pagefind-body>Embedded IoT 플랫폼에서 Wi-Fi 지원</h1><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><span class=screen-reader-text></span><a href=https://blog.humminglab.io/authors/yslee/><img class="tw-inline-block tw-max-h-4 tw-rounded-full tw-translate-y-[-2px] tw-mr-1" src="https://www.gravatar.com/avatar/ebfb7d4b2184ae7b5f72ef31ebd7cc61?s=240&d=mp" alt="YSLee avatar" height=16 width=16>YSLee</a></span>
</span>&nbsp;<span class=post-category>included in </span>&nbsp;<span class=post-category>category <a href=/categories/iot/><svg class="icon" viewBox="0 0 512 512"><path d="M464 128H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48C21.49 64 0 85.49.0 112v288c0 26.51 21.49 48 48 48h416c26.51.0 48-21.49 48-48V176c0-26.51-21.49-48-48-48zm0 272H48V112h140.12l54.63 54.63c6 6 14.14 9.37 22.63 9.37H464v224z"/></svg>IoT</a></span></div><div class=post-meta-line><svg class="icon" viewBox="0 0 448 512"><path d="M148 288h-40c-6.6.0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h48c26.5.0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3.0 6-2.7 6-6z"/></svg>&nbsp;<time datetime=2018-04-17>2018-04-17</time>&nbsp;<svg class="icon" viewBox="0 0 576 512"><path d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1.0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7.0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174 402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7-43.2-43.2c-4.1-4.1-10.8-4.1-14.8.0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"/></svg>&nbsp;<time datetime=2018-04-17>2018-04-17</time>&nbsp;<svg class="icon" viewBox="0 0 512 512"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3.0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9.0l60.1 60.1c18.8 18.7 18.8 49.1.0 67.9zM284.2 99.8 21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3.0-17l-111-111c-4.8-4.7-12.4-4.7-17.1.0zM124.1 339.9c-5.5-5.5-5.5-14.3.0-19.8l154-154c5.5-5.5 14.3-5.5 19.8.0s5.5 14.3.0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8.0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;1545 words&nbsp;
<svg class="icon" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5.0-2e2-89.5-2e2-2e2S145.5 56 256 56s2e2 89.5 2e2 2e2-89.5 2e2-2e2 2e2zm61.8-104.4-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6.0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;7 minutes&nbsp;</div></div><div class="details toc print:!tw-block" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span class=details-icon><svg class="icon" viewBox="0 0 256 512"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9.0l-22.6-22.6c-9.4-9.4-9.4-24.6.0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6.0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9.0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#constrained-devices>Constrained Devices</a></li><li><a href=#저사양-기기를-위한-wi-fi-지원>저사양 기기를 위한 Wi-Fi 지원</a></li><li><a href=#at-command-형태의-wi-fi-interface>AT command 형태의 Wi-Fi interface</a></li><li><a href=#일반-wi-fi-모듈>일반 Wi-Fi 모듈</a></li><li><a href=#마치며>마치며</a></li></ul></nav></div></div><div class=content id=content data-pagefind-body><p>Embedded 형태의 IoT의 센서 노드를 개발하기 위한 플랫폼(HW + SW SDK)은 다양해져서 잠깐만 인터넷 검색을 해보아도 여러 솔루션을 찾아 볼 수 있다. 특히 센서 노드의 특성 상 이들 SDK는 IEEE 802.15.4(Zigbee, Thread), IEEE 802.15.1(Bluetooth, BLE), IEEE 802.11(Wi-Fi)와 같은 wireless internet connectivity가 주요 기능으로 들어간다.</p><p>이 문서에서는 제품에 Wi-Fi 기능을 넣기 위하여 솔루션 선정 시 고려할 사항들을 정리한다.</p><h2 id=constrained-devices class=headerLink><a href=#constrained-devices class=header-mark></a>Constrained Devices</h2><p>IoT 센서 기기와 같은 경우는 배터리로 구동하거나, 낮은 사양 등 일반 PC 나 android 기기에 비하여 저사양 기기라고 할 수 있다. 보통 이를 constrained device 라고 한다(자세한 정의는 <a href=https://tools.ietf.org/html/rfc7228 target=_blank rel="noopener noreferrer">RFC 7228 Terminology for Constrained-Node Networks</a> 참고). 여기에서는 이를 &lsquo;저사양 기기&rsquo;라고 표기한다. 이들 저사양 기기는 일반 PC, 네트워크 환경에 비교하여 일반적으로 다음과 같은 사항 중 하나 이상에 해당될 수 있다.</p><ul><li>배터리 구동 등으로 전력 사용에 제한</li><li>메모리, 시스템 자원의 제한으로 <a href=http://freertos.org target=_blank rel="noopener noreferrer">FreeRTOS</a>와 같은 작은 OS를 사용하거나, 아니면 OS 없이 timer와 interrupt 로 구동</li><li>제한된 저속 네트워크 사용</li></ul><p>PC는 Windows, Linux 등의 범용 OS가 있고, 하드웨어도 PCI, USB, SDIO 등 표준화된 인터페이스와 OS에서 제공하는 해당 인터페이스의 프레임워크가 있어 새로운 기기를 붙이는 것이 어렵지 않으나, 이런 것이 없는 저사양 기기에서는 새로운 디바이스를 추가하는 것이 쉬운 일은 아니다.</p><h2 id=저사양-기기를-위한-wi-fi-지원 class=headerLink><a href=#%ec%a0%80%ec%82%ac%ec%96%91-%ea%b8%b0%ea%b8%b0%eb%a5%bc-%ec%9c%84%ed%95%9c-wi-fi-%ec%a7%80%ec%9b%90 class=header-mark></a>저사양 기기를 위한 Wi-Fi 지원</h2><p>모든 <a href=http://ieeexplore.ieee.org/browse/standards/get-program/page/ target=_blank rel="noopener noreferrer">IEEE 802</a> 프로토콜은 <a href=https://en.wikipedia.org/wiki/OSI_model target=_blank rel="noopener noreferrer">OSI Model</a>로 보면 Layer 1 Physical Layer와 Layer2 Data Link Layer를 정의한 표준이다. IEEE 802 프로토콜 위에 요구사항에 맞도록 다양한 프로토콜을 사용할 수 있다. 802.15.4를 보면 chip 솔루션 업체에서 상위 레이어를 개발이 가능하도록 driver와 API를 제공 하고, <a href=http://www.zigbee.org target=_blank rel="noopener noreferrer">Zigbee</a>, <a href=https://www.threadgroup.org target=_blank rel="noopener noreferrer">Thread</a>, <a href=https://en.wikipedia.org/wiki/WirelessHART target=_blank rel="noopener noreferrer">WirelessHart</a> 등 용도에 따라서 여러 프로토콜이 사용되고 있다.</p><p>802.15.4, 802.15.1 프로토콜은 PAN(Personal Area Network) 또는 센서 기기를 위한 프로토콜로 저속으로 작은 크기의 데이타를 전송하기 위한 용도가 주이다. 이와 대비하여 802.11 Wi-Fi는 근거리(Local Area Network)에서 802.3 ethernet과 유사한 수준의 무선 네트워크를 위한 프로토콜이다. LAN을 위한 표준 프로토콜인 TCP/IP가 있는 상태에서 다른 네트워크 프로토콜을 사용한다는 것은 넌센스 일 것이다. 이러므로 WiFi device 업체에서도 MS Windows, Linux 등의 OS에 TCP/IP 인터페이스에 연결되는 device driver 를 기본으로 제공한다.</p><p>802.15.4(LR-WPAN, Low-Rate Wireless PAN)와 같은 센서 전용 네트워크가 아닌 LAN용 802.11 Wi-Fi를 IoT 기기에서 지원하였을 때의 장점은 별도로 gateway(예를 들어서 zigbee to ip gatway) 구성 없이 기존 무선 AP를 연결하여 네트워크 구성이 가능하다는 것이다. 이같은 장점으로 인하여 Wi-Fi에 대한 요구는 당분간 꾸준히 있을 것으로 생각된다.</p><p>하지만 PC, Android가 아닌 작은 OS나 이마저도 사용하지 않는 사양이 제한된 센서 기기에서 Wi-Fi를 사용하는 것은 칩 솔루션 업체가 SDK를 제공하지 않는다면 쉬운 일이 아니다.</p><p>이들 기기를 위하여 Wi-Fi 솔루션을 제공하는 방법은 크게 두가지이다.</p><ul><li>Wi-Fi 모듈내에 802.11, TCP/IP, DHCP, HTTP 등 모든 네트워크 프로토콜 제공. 외부의 host와는 UART로 연결되어 AT command를 이용하여 무선랜 이용.</li></ul><figure><a class=lightgallery href=/posts/wifi-for-iot-product/target-wifi.png title data-thumbnail=/posts/wifi-for-iot-product/target-wifi.png data-sub-html="<h2>TCP/IP in Wi-Fi</h2>"><img loading=lazy src=/posts/wifi-for-iot-product/target-wifi.png height=auto width=400px></a><figcaption class=image-caption>TCP/IP in Wi-Fi</figcaption></figure><ul><li>Wi-Fi 모듈은 802.11 device 역할만 수행하고, host PC와는 SDIO, USB 등으로 연결. Host 컨트롤러에서 Wi-Fi driver 및 TCP/IP 지원.</li></ul><figure><a class=lightgallery href=/posts/wifi-for-iot-product/host-wifi.png title data-thumbnail=/posts/wifi-for-iot-product/host-wifi.png data-sub-html="<h2>TCP/IP in Host</h2>"><img loading=lazy src=/posts/wifi-for-iot-product/host-wifi.png height=auto width=400px></a><figcaption class=image-caption>TCP/IP in Host</figcaption></figure><p>PC 급에서는 두번째 방식이 일반적 이겠지만, 저사양 기기에서는 첫번째 방식이 기존에 사용하던 host 컨트롤러와 소프트웨어 환경을 크게 바꾸지 않고 사용할 수 있다는 장점으로 많이 사용한다.</p><p>다음 절에서는 이 두 방법의 특징 및 장단점을 정리해 본다.</p><h2 id=at-command-형태의-wi-fi-interface class=headerLink><a href=#at-command-%ed%98%95%ed%83%9c%ec%9d%98-wi-fi-interface class=header-mark></a>AT command 형태의 Wi-Fi interface</h2><p>UART를 이용한 데이타 통신은 AT 커맨드를 이용하는 것이 업계 표준이라 대부분이 AT 캐맨드 형태로 API를 제공하나 때에 따라서는 JSON 등 다른 데이타 형식을 사용하기도 한다.</p><p>이 방식의 가장 큰 장점은 다음과 같다.</p><ul><li>Host 모듈에 TCP/IP stack이나 OS가 없어도 가능</li><li>센서 기기의 펌웨어 개발자가 TCP/IP, Wi-Fi 등에 대한 세부 개발 지식없이도 개발 가능</li></ul><p>기존의 기기에 WiFi 모듈 연결과 host CPU에서 AT 커맨드를 이용한 네트워크 데이타 송수신 구현으로 어렵지 않게 IoT 기기로 변화가 가능하다.</p><p>AT 커맨드는 Wi-Fi, TCP/IP, DHCP, Socket, HTTP 등에 대한 넓은 범위의 API를 제공하여야 하기 때문에 보통은 세부적인 컨트롤을 할 수 있는 부분은 제공하지 않고, 가능한 쉽게 사용할 수 있는 명령이나 이벤트를 제공한다. 제공하는 기능을 크게 나누어 보면 다음과 같을 것이다.</p><ul><li>무선랜 스캔</li><li>Station, AP, Direct 모드 설정 및 연결 관리</li><li>DHCP / IP 설정</li><li>DNS, PING, TCP, UDP, HTTP 통신</li></ul><p>TCP/UDP/HTTP 통신은 socket API가 아니라 간단히 말해서 <a href=https://en.wikipedia.org/wiki/CURL target=_blank rel="noopener noreferrer">cURL</a> utility를 이용하여 HTTP 통신을 하는 것과 비슷하다고 보면 된다.</p><p>센서 기기를 개발하는 시스템 프로그래밍 개발자에게는 새로운 것을 배우는 부담을 줄일 수 있어 현실적인 개발 모델이 될 것이다. 하지만 이같은 편리함은 있지만 상대적인 단점이 몇가지 있다.</p><p>첫번째 단점은 Wi-Fi 호환성 문제가 발생 시 대응이 쉽지 않다는 것이다. 이 부분은 두번째 모델에도 공통된 문제 일테지만, AT커맨드 방식은 더 많이 감싸져 있어 문제 해결이 더 어렵다. 다음과 같은 사항이 문제가 될 것이다.</p><ul><li>특정 Wi-Fi AP가 아닌 일반 AP를 사용하는 경우 AP의 버그 등으로 인하여 문제 발생 가능성 있음.</li><li>이 경우 무선랜 패킷 분석 능력이 없으면 Wi-Fi 모듈 업체에 문제 상황 리포트가 어려움</li></ul><p>일반적인 AP의 버그라면 같이 사용하는 PC 에서도 쉽게 발생할 수 있어 그나마 다행이나, 다음과 같은 버그는 쉽게 재현이 되지 않아 센서 기기에 유독 치명적일 수 있다.</p><ul><li>Wi-Fi power save 모드의 버그로 인하여 power save 모드에서 패킷 수신 불가능</li><li>장시간 연결 시 Wi-Fi association 관리 오류로 AP 송수신 불안정</li></ul><p>PC의 경우는 사용자에 의하여 웹 브라우저 등을 사용하게 되면 Wi-Fi power save에서 나온 후 외부로 패킷이 나가는 구조라 보통 위 상황이 문제가 되지 않고, 혹 문제가 되더라고 사용자가 바로 껏다 켜는 등의 조치가 가능하다. 하지만 홀로 동작하는 센서 기기는 외부로 리포트 주기가 긴 상태에서 외부 제어 명령도 수신을 하여야 하는 경우라면 제어 명령을 정상적으로 수신을 못하는 등의 치명적인 문제가 발생할 수 있고, 또한 이에 대한 대처도 쉽지 않다.</p><p>참고로 초창기 가정용 WiFi 전화기를 개발하였을 때도 이와 같은 타 AP의 문제로 인하여 수많은 장애 리포트가 있었는데, 이를 크게 줄인 방법 중 하나가 전화기를 충전 크래들에 올려둔 상태에서는 Wi-Fi power save를 나오도록 한 것이었다. 이렇게하여 AP의 버그로 인하여 수신전화를 못받는 경우를 크게 줄일 수 있었다.</p><p>두번째 단점은 AT 커맨드가 표준이 아니라는 것이다. BLE(Bluetooth Low Energy)의 경우도 마찬가지로 UART host 인터페이스를 제공하지만, 이는 표준의 HCI(Host Control Interface)로 정의된 사항을 이용한 것으로 일반 동작만이 아니라 production line test 까지도 모두 정의되어 있다(참고: <a href=https://www.bluetooth.com/specifications/bluetooth-core-specification target=_blank rel="noopener noreferrer">Bluetooth Core Speicificaiton</a> Part E. Host Controller Interface Functional Specification).</p><p>Wi-Fi 디바이스의 경우 보통 chip vendor는 IEEE 802.11 표준 문서의 10장 Layer Management에 정의된 MLME(MAC Layer Management Entity) interface에 따라서 device driver와의 API를 구현한다. 하지만 AT 커맨드를 제공하는 모듈은 이 API가 아닌 Wi-Fi, socket, protocol을 모두 포함한 포괄적인 자체 AT 커맨드를 제공하여 구현 업체마다 범위가 제각각이라 이를 이용 시 모듈업체의 AT 커맨드 사양에 따라서 기능 제한이 될 수 있다. API 제한으로 인하여 제품의 기능을 구현하는데 문제가 될 수도 있다.</p><p>세번째 단점은 대역 병목 현상이 발생할 수 있다는 것이다. 802.11b/g/n의 경우 보통 54~72.2MBps의 최대 전송속도를 가진다. Wi-Fi device는 보통 controller와 4bits 25MHz SDIO (100Mbps)로 연결되어 있어 하드웨어적인 병목 구간이 없다. 하지만 UART를 사용하는 경우에는 보통 115,200bsp(112.5kbps)로 외부 대역에 비하여 UART가 병목 구간이 될 수 있다. 작은 데이타를 송수신하는 센서 노드 에서는 큰 문제가 안되나, OTA(Over-the-air programming) 등 짧은 시간에 큰 대역을 사용하려고 할 때 UART 병목에 따라 TCP handshaking이 컨트롤 되지 않는다면 손실이 되는 등의 문제가 발생할 수도 있다.</p><p>간단하게 정리하자면 항상 페어로 연결하는 AP 제품이 정해져 있고, 서버의 명령에 제어되는 것보다는 서버로의 주기적인 리포트가 주요 사항인 기기라면 큰 문제가 없을 것이나, 이 범위 이상이라면 초기 선정 시 업체의 신뢰도, API 제공 범위, 기본 성능 시험 등을 충분히 한 후에 적용을 검토하여야 할 것이다.</p><h2 id=일반-wi-fi-모듈 class=headerLink><a href=#%ec%9d%bc%eb%b0%98-wi-fi-%eb%aa%a8%eb%93%88 class=header-mark></a>일반 Wi-Fi 모듈</h2><p>일반 PC에서 사용하는 것과 같이 SDIO, USB 등의 host interface를 제공하고, MAC layer 이상을 host driver 루틴에서 구현하는 방식이다.</p><p>이 부분의 우선 큰 걸림돌은 Wi-Fi device, Host controller, OS를 모두 제공하는 솔루션이 아니라면 실제 적용이 불가능하다고 보아야 한다. Windows나 linux driver를 가지고 사용하는 host controller와 OS에 포팅을 하는 것도 고려 할 수 있겠지만 이 경우 SDIO driver도 구현하여야 하고, 802.11i(WPA) security를 지원하기 위하여 TCP/IP stack 만이 아니라 SSL/TLS library도 포팅하여야 한다. 그나마 최근에는 Apache 2.0 license인 <a href=https://tls.mbed.org target=_blank rel="noopener noreferrer">Mbed TLS(PolarSSL)</a>가 있어 다른 RTOS로 포팅이 그나마 수월해졌다.</p><p>센서 기기를 위하여 위와 같은 일을 하기에는 개발 범위가 너무 커지므로 host, wifi 가 모듈로 포함되어 있고, OS, wi-fi 를 지원하는 솔루션을 찾아야 한다.</p><p>이런 솔루션을 찾다보면 Wi-Fi chip은 아래 정도로 좁혀진다.</p><ul><li><a href=https://www.espressif.com target=_blank rel="noopener noreferrer">Espressif</a> <a href=https://www.espressif.com/en/products/hardware/socs target=_blank rel="noopener noreferrer">ESP8266</a></li><li><a href=http://www.cypress.com/ target=_blank rel="noopener noreferrer">Cyperss(구 broadcom)</a> CYW4334x, CYW4343x, CYW43362, CYW4390x (제품에 따라 IEEE 802.11a 5Ghz 있음)</li><li><a href=https://www.amebaiot.com/en/ target=_blank rel="noopener noreferrer">Realtek</a> RTL8195, RTL8710/8711</li><li><a href=https://labs.mediatek.com/en/chipset/MT7697 target=_blank rel="noopener noreferrer">MediaTek MT7697</a></li><li><a href=https://www.marvell.com/microcontrollers/88mw30x/ target=_blank rel="noopener noreferrer">Marvell 88MW300/302</a> (publc으로는 비공개)</li></ul><p>위의 chip들은 IoT를 타겟으로 하여 마케팅을 하고 있어, 제한된 범위지만 인터넷에서 관련 자료와 오픈된 소스를 구할 수 있다.</p><p>사용할 수 있는 솔루션을 정리해보면 다음과 같다.</p><div class=table-wrapper><table><thead><tr><th style=text-align:>솔루션</th><th style=text-align:>Wi-Fi</th><th style=text-align:>OS</th></tr></thead><tbody><tr><td style=text-align:><a href=https://www.espressif.com/en/products/hardware/esp8266ex/overview target=_blank rel="noopener noreferrer">Espressif</a></td><td style=text-align:>ESP8266</td><td style=text-align:>freertos</td></tr><tr><td style=text-align:>Cypress <a href=http://www.cypress.com/products/wiced-software target=_blank rel="noopener noreferrer">Wiced</a></td><td style=text-align:>Cypress</td><td style=text-align:>threadx / freertos</td></tr><tr><td style=text-align:>Realtek <a href=https://www.amebaiot.com/en/ target=_blank rel="noopener noreferrer">Ameba</a></td><td style=text-align:>Realtek</td><td style=text-align:>freertos</td></tr><tr><td style=text-align:>MXHCIP <a href=http://developer.mxchip.com target=_blank rel="noopener noreferrer">MiCO</a></td><td style=text-align:>Cypress/Realtek</td><td style=text-align:>자체</td></tr><tr><td style=text-align:>ARM <a href=https://www.mbed.com target=_blank rel="noopener noreferrer">MBed</a></td><td style=text-align:>RTL8195</td><td style=text-align:>MBed OS</td></tr></tbody></table></div><p>위의 링크들은 CPU controller + Wi-Fi + OS + TCP/IP + SSL/TLS 등이 모두 포함된 솔루션이다.</p><p>이와 같은 솔루션의 장점은 802.11 MAC layer 이상은 모두 소스로 제공되기 때문에 마음만 먹으면 원하는 기능을 구현할 수 있다는 것이다. Wiced 소스를 예를 들면 amazon alexa, apple homekit 등 다양한 샘플코드를 같이 제공한다.</p><p>이 방식의 가장 큰 장점은 모듈상의 컨트롤러에서 제공하는 GPIO, PWM, ADC, I2C, SPI 등 여러 외부 인터페이스를 사용할 수 있고, 이 CPU 위에 제품의 기능을 위한 코드를 올릴 수 있어 외부 host controller를 별도로 사용할 필요가 없어 제품의 가격을 낮출 수 있다는 것이다. ESP8266, RTL8195 와 같은 chip은 host controller까지 포함된 one chip 솔루션으로 작은 수량으로 모듈 구매시에도 1~2불대의 가격으로 구매가 가능하다.</p><p>이 장점이 단점이 될 수 있는데, 실 동작을 하기 위하여는 최소한 이들 솔루션에 대해서 이해하고 개발할 능력이 되어야 한다는 것이다. 이런 부분에 한 이해를 정확히 못하고 개발을 한다면 AT 방식을 사용하는 것이 비하여 더 많은 문제를 야기할 수도 있다.</p><h2 id=마치며 class=headerLink><a href=#%eb%a7%88%ec%b9%98%eb%a9%b0 class=header-mark></a>마치며</h2><p>개발에 적용시 두가지 방식의 솔루션 중 어느 것을 적용하는 것이 좋을 지는 결정하기 어려울 수 있다.</p><p>IoT 모듈 솔루션의 가장 중요한 부분은 security, ota(maintenance), stability 일 것이다. 하지만 위 방식 모두 개발자가 직접 이를 확보하기 위하여 많은 고민을 하여야 하는 상황이다. 그나마 AT 커맨드 방식이 단순하고 정형화 되어 있어 어느 정도 낫다고는 할 수 있다.</p><p>향후에는 <a href=https://www.mbed.com/en/technologies/security/uvisor/ target=_blank rel="noopener noreferrer">Mbed uVisor</a>와 같은 시스템 보호 매커니즘과 websock API 같은 정형화된 안정적인 네트워크 전송 방법 들이 갖추어진 솔루션이 만들어 진다면 좀더 확실한 솔루션이 되지 않을까 생각해본다.</p><p>여기에서는 이 정도로 마무리하고, 다음 기회엥는 두번째 방식인 Wi-Fi driver를 직접 사용하는 방식의 솔루션들에 대해서 좀더 세부적인 사항을 정리해 보기로 한다.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2018-04-17</span></div><div class=post-info-license></div></div><div class="post-info-line print:!tw-hidden"><div class=post-info-md></div><div class=post-info-share></div></div></div><div class=post-info-more><section class=post-tags><svg class="icon" viewBox="0 0 640 512"><path d="M497.941 225.941 286.059 14.059A48 48 0 00252.118.0H48C21.49.0.0 21.49.0 48v204.118a48 48 0 0014.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882.0l204.118-204.118c18.745-18.745 18.745-49.137.0-67.882zM112 160c-26.51.0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882.0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397.0h48.721a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882z"/></svg>&nbsp;<a href=/tags/iot/>IoT</a>,&nbsp;<a href=/tags/wi-fi/>Wi-Fi</a></section><section class=print:!tw-hidden><span><button class="tw-text-fgColor-link-muted hover:tw-text-fgColor-link-muted-hover" onclick=window.history.back()>Back</button></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class="post-nav print:tw-hidden"><a href=/posts/python-coroutine-programming-2/ class=prev rel=prev title="Python 비동기 프로그래밍 제대로 이해하기(2/2) - Asyncio, Coroutine"><svg class="icon" viewBox="0 0 256 512"><path d="M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9.0l22.6 22.6c9.4 9.4 9.4 24.6.0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6.0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9.0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"/></svg>Python 비동기 프로그래밍 제대로 이해하기(2/2) - Asyncio, Coroutine</a>
<a href=/posts/wiced-event-loop/ class=next rel=next title="WICED eventloop library">WICED eventloop library<svg class="icon" viewBox="0 0 256 512"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9.0l-22.6-22.6c-9.4-9.4-9.4-24.6.0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6.0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9.0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></a></div></div><div id=comments class="print:!tw-hidden tw-pt-32 tw-pb-8"><div id=giscus></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/>giscus</a>.</noscript></div></article></main><footer class=footer><div class=footer-container><div class=footer-line><svg class="icon" viewBox="0 0 512 512"><path d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 448c-110.532.0-2e2-89.451-2e2-2e2.0-110.531 89.451-2e2 2e2-2e2 110.532.0 2e2 89.451 2e2 2e2.0 110.532-89.451 2e2-2e2 2e2zm107.351-101.064c-9.614 9.712-45.53 41.396-104.065 41.396-82.43.0-140.484-61.425-140.484-141.567.0-79.152 60.275-139.401 139.762-139.401 55.531.0 88.738 26.62 97.593 34.779a11.965 11.965.0 011.936 15.322l-18.155 28.113c-3.841 5.95-11.966 7.282-17.499 2.921-8.595-6.776-31.814-22.538-61.708-22.538-48.303.0-77.916 35.33-77.916 80.082.0 41.589 26.888 83.692 78.277 83.692 32.657.0 56.843-19.039 65.726-27.225 5.27-4.857 13.596-4.039 17.82 1.738l19.865 27.17a11.947 11.947.0 01-1.152 15.518z"/></svg>2025<span class=author>&nbsp;<a href=https://www.humminglab.io target=_blank rel="noopener noreferrer">HummingLab</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer><div class="print:!tw-hidden tw-flex tw-flex-col tw-fixed tw-right-4 tw-bottom-4 tw-gap-2"><a href=#back-to-top id=back-to-top-button class="tw-transition-opacity tw-opacity-0 tw-block tw-bg-bgColor-secondary tw-rounded-full" style=padding:.6rem;line-height:1.3rem;font-size:1rem title="Back to Top"><svg class="icon" viewBox="0 0 448 512"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg>
</a><button id=toc-drawer-button class="tw-block tw-bg-bgColor-secondary tw-rounded-full md:tw-hidden" style=padding:.6rem;line-height:1.3rem;font-size:1rem>
<svg class="icon" viewBox="0 0 448 512"><path d="M16 132h416c8.837.0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163.0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg>
</button><a href=#comments id=view-comments class="tw-block tw-bg-bgColor-secondary tw-rounded-full" style=padding:.6rem;line-height:1.3rem;font-size:1rem title="View Comments"><svg class="icon" viewBox="0 0 512 512"><path d="M256 32C114.6 32 0 125.1.0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3.0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4.0 256-93.1 256-208S397.4 32 256 32z"/></svg></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/katex/copy-tex.min.css><noscript><link rel=stylesheet href=/lib/katex/copy-tex.min.css></noscript><script>window.config={comment:{giscus:{darkTheme:"dark",dataCategory:"Announcements",dataCategoryId:"DIC_kwDOGdk00s4CAGXN",dataEmitMetadata:"0",dataInputPosition:"bottom",dataLang:"en",dataLoading:"lazy",dataMapping:"pathname",dataReactionsEnabled:"1",dataRepo:"humminglab/blog.humminglab.io",dataRepoId:"R_kgDOGdk00g",dataStrict:"0",lightTheme:"light"}},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/js/katex.min.js defer></script><script src=/js/theme.min.js defer></script><script src=/js/giscus.min.js defer></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-83257319-3",{anonymize_ip:!0})</script><script src="https://www.googletagmanager.com/gtag/js?id=UA-83257319-3" async></script><script type=speculationrules>
  {
    "prerender": [
      {
        "where": { "href_matches": "/*" },
        "eagerness": "moderate"
      }
    ]
  }
</script></body></html>